from __future__ import annotations\nimport json\nimport os\nfrom pathlib import Path\nfrom typing import Dict, List\n\n__all__ = ["DataHealthChecker", "create_health_checker"]\n\n\nclass DataHealthChecker:\n    def __init__(self, data_dir: str) -> None:\n        self.data_dir = Path(data_dir)\n    \n    def check_file_integrity(self, file_path: str) -> bool:\n        try:\n            with open(file_path, "r", encoding="utf-8") as f:\n                json.load(f)\n            return True\n        except (json.JSONDecodeError, FileNotFoundError):\n            return False\n    \n    def health_check_and_repair(self, file_paths: List[str]) -> Dict[str, bool]:\n        results: Dict[str, bool] = {}\n        for file_path in file_paths:\n            if os.path.exists(file_path):\n                results[file_path] = self.check_file_integrity(file_path)\n            else:\n                results[file_path] = True\n        return results\n\n\ndef create_health_checker(base_file: str) -> DataHealthChecker:\n    data_dir = os.path.join(os.path.dirname(os.path.dirname(base_file)), "data")\n    return DataHealthChecker(data_dir)
